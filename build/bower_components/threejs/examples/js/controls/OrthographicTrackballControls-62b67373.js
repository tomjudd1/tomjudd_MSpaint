THREE.OrthographicTrackballControls=function(t,e){function o(t){d.enabled!==!1&&(window.removeEventListener("keydown",o),m=E,E===u.NONE&&(t.keyCode!==d.keys[u.ROTATE]||d.noRotate?t.keyCode!==d.keys[u.ZOOM]||d.noZoom?t.keyCode!==d.keys[u.PAN]||d.noPan||(E=u.PAN):E=u.ZOOM:E=u.ROTATE))}function n(){d.enabled!==!1&&(E=m,window.addEventListener("keydown",o,!1))}function a(t){d.enabled!==!1&&(t.preventDefault(),t.stopPropagation(),E===u.NONE&&(E=t.button),E!==u.ROTATE||d.noRotate?E!==u.ZOOM||d.noZoom?E!==u.PAN||d.noPan||(j.copy(k(t.pageX,t.pageY)),R.copy(j)):(f.copy(k(t.pageX,t.pageY)),w.copy(f)):(y.copy(A(t.pageX,t.pageY)),v.copy(y)),document.addEventListener("mousemove",i,!1),document.addEventListener("mouseup",s,!1),d.dispatchEvent(H))}function i(t){d.enabled!==!1&&(t.preventDefault(),t.stopPropagation(),E!==u.ROTATE||d.noRotate?E!==u.ZOOM||d.noZoom?E!==u.PAN||d.noPan||R.copy(k(t.pageX,t.pageY)):w.copy(k(t.pageX,t.pageY)):v.copy(A(t.pageX,t.pageY)))}function s(t){d.enabled!==!1&&(t.preventDefault(),t.stopPropagation(),E=u.NONE,document.removeEventListener("mousemove",i),document.removeEventListener("mouseup",s),d.dispatchEvent(M))}function c(t){if(d.enabled!==!1){t.preventDefault(),t.stopPropagation();var e=0;t.wheelDelta?e=t.wheelDelta/40:t.detail&&(e=-t.detail/3),f.y+=.01*e,d.dispatchEvent(H),d.dispatchEvent(M)}}function r(t){if(d.enabled!==!1){switch(t.touches.length){case 1:E=u.TOUCH_ROTATE,y.copy(A(t.touches[0].pageX,t.touches[0].pageY)),v.copy(y);break;case 2:E=u.TOUCH_ZOOM_PAN;var e=t.touches[0].pageX-t.touches[1].pageX,o=t.touches[0].pageY-t.touches[1].pageY;T=O=Math.sqrt(e*e+o*o);var n=(t.touches[0].pageX+t.touches[1].pageX)/2,a=(t.touches[0].pageY+t.touches[1].pageY)/2;j.copy(k(n,a)),R.copy(j);break;default:E=u.NONE}d.dispatchEvent(H)}}function h(t){if(d.enabled!==!1)switch(t.preventDefault(),t.stopPropagation(),t.touches.length){case 1:v.copy(A(t.touches[0].pageX,t.touches[0].pageY));break;case 2:var e=t.touches[0].pageX-t.touches[1].pageX,o=t.touches[0].pageY-t.touches[1].pageY;T=Math.sqrt(e*e+o*o);var n=(t.touches[0].pageX+t.touches[1].pageX)/2,a=(t.touches[0].pageY+t.touches[1].pageY)/2;R.copy(k(n,a));break;default:E=u.NONE}}function p(t){if(d.enabled!==!1){switch(t.touches.length){case 1:v.copy(A(t.touches[0].pageX,t.touches[0].pageY)),y.copy(v);break;case 2:O=T=0;var e=(t.touches[0].pageX+t.touches[1].pageX)/2,o=(t.touches[0].pageY+t.touches[1].pageY)/2;R.copy(k(e,o)),j.copy(R)}E=u.NONE,d.dispatchEvent(M)}}var d=this,u={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4};this.object=t,this.domElement=void 0!==e?e:document,this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.radius=0,this.rotateSpeed=1,this.zoomSpeed=1.2,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.noRoll=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.keys=[65,83,68],this.target=new THREE.Vector3;var g=1e-6,l=!0,E=u.NONE,m=u.NONE,b=new THREE.Vector3,y=new THREE.Vector3,v=new THREE.Vector3,f=new THREE.Vector2,w=new THREE.Vector2,O=0,T=0,j=new THREE.Vector2,R=new THREE.Vector2;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone(),this.left0=this.object.left,this.right0=this.object.right,this.top0=this.object.top,this.bottom0=this.object.bottom;var N={type:"change"},H={type:"start"},M={type:"end"};this.handleResize=function(){if(this.domElement===document)this.screen.left=0,this.screen.top=0,this.screen.width=window.innerWidth,this.screen.height=window.innerHeight;else{var t=this.domElement.getBoundingClientRect(),e=this.domElement.ownerDocument.documentElement;this.screen.left=t.left+window.pageXOffset-e.clientLeft,this.screen.top=t.top+window.pageYOffset-e.clientTop,this.screen.width=t.width,this.screen.height=t.height}this.radius=.5*Math.min(this.screen.width,this.screen.height),this.left0=this.object.left,this.right0=this.object.right,this.top0=this.object.top,this.bottom0=this.object.bottom},this.handleEvent=function(t){"function"==typeof this[t.type]&&this[t.type](t)};var k=function(){var t=new THREE.Vector2;return function(e,o){return t.set((e-d.screen.left)/d.screen.width,(o-d.screen.top)/d.screen.height),t}}(),A=function(){var t=new THREE.Vector3,e=new THREE.Vector3,o=new THREE.Vector3;return function(n,a){o.set((n-.5*d.screen.width-d.screen.left)/d.radius,(.5*d.screen.height+d.screen.top-a)/d.radius,0);var i=o.length();return d.noRoll?o.z=i<Math.SQRT1_2?Math.sqrt(1-i*i):.5/i:i>1?o.normalize():o.z=Math.sqrt(1-i*i),b.copy(d.object.position).sub(d.target),t.copy(d.object.up).setLength(o.y),t.add(e.copy(d.object.up).cross(b).setLength(o.x)),t.add(b.setLength(o.z)),t}}();this.rotateCamera=function(){var t=new THREE.Vector3,e=new THREE.Quaternion;return function(){var o=Math.acos(y.dot(v)/y.length()/v.length());o&&(t.crossVectors(y,v).normalize(),o*=d.rotateSpeed,e.setFromAxisAngle(t,-o),b.applyQuaternion(e),d.object.up.applyQuaternion(e),v.applyQuaternion(e),d.staticMoving?y.copy(v):(e.setFromAxisAngle(t,o*(d.dynamicDampingFactor-1)),y.applyQuaternion(e)),l=!0)}}(),this.zoomCamera=function(){if(E===u.TOUCH_ZOOM_PAN){var t=T/O;O=T,d.object.zoom*=t,l=!0}else{var t=1+(w.y-f.y)*d.zoomSpeed;Math.abs(t-1)>g&&t>0&&(d.object.zoom*=t,d.staticMoving?f.copy(w):f.y+=(w.y-f.y)*this.dynamicDampingFactor,l=!0)}},this.panCamera=function(){var t=new THREE.Vector2,e=new THREE.Vector3,o=new THREE.Vector3;return function(){if(t.copy(R).sub(j),t.lengthSq()){var n=(d.object.right-d.object.left)/d.object.zoom,a=(d.object.top-d.object.bottom)/d.object.zoom;t.x*=n,t.y*=a,o.copy(b).cross(d.object.up).setLength(t.x),o.add(e.copy(d.object.up).setLength(t.y)),d.object.position.add(o),d.target.add(o),d.staticMoving?j.copy(R):j.add(t.subVectors(R,j).multiplyScalar(d.dynamicDampingFactor)),l=!0}}}(),this.update=function(){b.subVectors(d.object.position,d.target),d.noRotate||d.rotateCamera(),d.noZoom||(d.zoomCamera(),l&&d.object.updateProjectionMatrix()),d.noPan||d.panCamera(),d.object.position.addVectors(d.target,b),d.object.lookAt(d.target),l&&(d.dispatchEvent(N),l=!1)},this.reset=function(){E=u.NONE,m=u.NONE,d.target.copy(d.target0),d.object.position.copy(d.position0),d.object.up.copy(d.up0),b.subVectors(d.object.position,d.target),d.object.left=d.left0,d.object.right=d.right0,d.object.top=d.top0,d.object.bottom=d.bottom0,d.object.lookAt(d.target),d.dispatchEvent(N),l=!1},this.domElement.addEventListener("contextmenu",function(t){t.preventDefault()},!1),this.domElement.addEventListener("mousedown",a,!1),this.domElement.addEventListener("mousewheel",c,!1),this.domElement.addEventListener("DOMMouseScroll",c,!1),this.domElement.addEventListener("touchstart",r,!1),this.domElement.addEventListener("touchend",p,!1),this.domElement.addEventListener("touchmove",h,!1),window.addEventListener("keydown",o,!1),window.addEventListener("keyup",n,!1),this.handleResize(),this.update()},THREE.OrthographicTrackballControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.OrthographicTrackballControls.prototype.constructor=THREE.OrthographicTrackballControls;