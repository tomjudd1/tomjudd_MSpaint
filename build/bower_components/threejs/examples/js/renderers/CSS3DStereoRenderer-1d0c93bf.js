THREE.CSS3DObject=function(e){THREE.Object3D.call(this),this.elementL=e.cloneNode(!0),this.elementL.style.position="absolute",this.elementR=e.cloneNode(!0),this.elementR.style.position="absolute",this.addEventListener("removed",function(){null!==this.elementL.parentNode&&this.elementL.parentNode.removeChild(this.elementL),null!==this.elementR.parentNode&&this.elementR.parentNode.removeChild(this.elementR)})},THREE.CSS3DObject.prototype=Object.create(THREE.Object3D.prototype),THREE.CSS3DObject.prototype.constructor=THREE.CSS3DObject,THREE.CSS3DSprite=function(e){THREE.CSS3DObject.call(this,e)},THREE.CSS3DSprite.prototype=Object.create(THREE.CSS3DObject.prototype),THREE.CSS3DSprite.prototype.constructor=THREE.CSS3DSprite,THREE.CSS3DStereoRenderer=function(){console.log("THREE.CSS3DRenderer",THREE.REVISION);var e,t,r,s,o=new THREE.Matrix4,n=new THREE.Vector3,l=new THREE.Quaternion,a=new THREE.Vector3,i=new THREE.PerspectiveCamera,p=new THREE.PerspectiveCamera,d=new THREE.Vector3;this.separation=6,this.targetDistance=500;var y=document.createElement("div");this.domElement=y;var c=document.createElement("div");c.style.display="inline-block",c.style.overflow="hidden",c.style.WebkitTransformStyle="preserve-3d",c.style.MozTransformStyle="preserve-3d",c.style.oTransformStyle="preserve-3d",c.style.transformStyle="preserve-3d",y.appendChild(c);var m=document.createElement("div");m.style.WebkitTransformStyle="preserve-3d",m.style.MozTransformStyle="preserve-3d",m.style.oTransformStyle="preserve-3d",m.style.transformStyle="preserve-3d",c.appendChild(m);var v=document.createElement("div");v.style.display="inline-block",v.style.overflow="hidden",v.style.WebkitTransformStyle="preserve-3d",v.style.MozTransformStyle="preserve-3d",v.style.oTransformStyle="preserve-3d",v.style.transformStyle="preserve-3d",y.appendChild(v);var E=document.createElement("div");E.style.WebkitTransformStyle="preserve-3d",E.style.MozTransformStyle="preserve-3d",E.style.oTransformStyle="preserve-3d",E.style.transformStyle="preserve-3d",v.appendChild(E),this.setClearColor=function(){},this.setSize=function(o,n){y.style.width=o+"px",y.style.height=n+"px",e=o/2,t=n,r=e/2,s=t/2,c.style.width=e+"px",c.style.height=t+"px",m.style.width=e+"px",m.style.height=t+"px",v.style.width=e+"px",v.style.height=t+"px",E.style.width=e+"px",E.style.height=t+"px"};var f=function(e){return Math.abs(e)<1e-6?0:e},h=function(e){var t=e.elements;return"matrix3d("+f(t[0])+","+f(-t[1])+","+f(t[2])+","+f(t[3])+","+f(t[4])+","+f(-t[5])+","+f(t[6])+","+f(t[7])+","+f(t[8])+","+f(-t[9])+","+f(t[10])+","+f(t[11])+","+f(t[12])+","+f(-t[13])+","+f(t[14])+","+f(t[15])+")"},S=function(e){var t=e.elements;return"translate3d(-50%,-50%,0) matrix3d("+f(t[0])+","+f(t[1])+","+f(t[2])+","+f(t[3])+","+f(-t[4])+","+f(-t[5])+","+f(-t[6])+","+f(-t[7])+","+f(t[8])+","+f(t[9])+","+f(t[10])+","+f(t[11])+","+f(t[12])+","+f(t[13])+","+f(t[14])+","+f(t[15])+")"},T=function(e,t,r,s){if(e instanceof THREE.CSS3DObject){var n;e instanceof THREE.CSS3DSprite?(o.copy(t.matrixWorldInverse),o.transpose(),o.copyPosition(e.matrixWorld),o.scale(e.scale),o.elements[3]=0,o.elements[7]=0,o.elements[11]=0,o.elements[15]=1,n=S(o)):n=S(e.matrixWorld);var l=e["element"+s];l.style.WebkitTransform=n,l.style.MozTransform=n,l.style.oTransform=n,l.style.transform=n,l.parentNode!==r&&r.appendChild(l)}for(var a=0,i=e.children.length;i>a;a++)T(e.children[a],t,r,s)};this.render=function(e,o){e.updateMatrixWorld(),void 0===o.parent&&o.updateMatrixWorld(),o.matrixWorld.decompose(n,l,a),d.set(0,0,-this.targetDistance),d.applyQuaternion(l),d.add(n);var y=.5/Math.tan(THREE.Math.degToRad(.5*o.fov))*t;i.fov=o.fov,i.aspect=.5*o.aspect,i.updateProjectionMatrix(),i.near=o.near,i.far=o.far,i.position.copy(n),i.translateX(-this.separation),i.lookAt(d),i.updateMatrixWorld(),c.style.WebkitPerspective=y+"px",c.style.MozPerspective=y+"px",c.style.oPerspective=y+"px",c.style.perspective=y+"px",i.matrixWorldInverse.getInverse(i.matrixWorld);var f="translate3d(0,0,"+y+"px)"+h(i.matrixWorldInverse)+" translate3d("+r+"px,"+s+"px, 0)";m.style.WebkitTransform=f,m.style.MozTransform=f,m.style.oTransform=f,m.style.transform=f,T(e,i,m,"L"),p.projectionMatrix=i.projectionMatrix,p.near=o.near,p.far=o.far,p.position.copy(n),p.translateX(this.separation),p.lookAt(d),p.updateMatrixWorld(),v.style.WebkitPerspective=y+"px",v.style.MozPerspective=y+"px",v.style.oPerspective=y+"px",v.style.perspective=y+"px",p.matrixWorldInverse.getInverse(p.matrixWorld);var f="translate3d(0,0,"+y+"px)"+h(p.matrixWorldInverse)+" translate3d("+r+"px,"+s+"px, 0)";E.style.WebkitTransform=f,E.style.MozTransform=f,E.style.oTransform=f,E.style.transform=f,T(e,p,E,"R")}};