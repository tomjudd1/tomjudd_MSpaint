THREE.STLLoader=function(t){this.manager=void 0!==t?t:THREE.DefaultLoadingManager},THREE.STLLoader.prototype={constructor:THREE.STLLoader,load:function(t,e,r,n){var a=this,i=new THREE.XHRLoader(a.manager);i.setCrossOrigin(this.crossOrigin),i.setResponseType("arraybuffer"),i.load(t,function(t){e(a.parse(t))},r,n)},parse:function(t){var e=function(){var t,e,n,a;if(a=new DataView(r),e=50,n=a.getUint32(80,!0),t=84+n*e,t===a.byteLength)return!0;for(var i=a.byteLength,o=0;i>o;o++)if(a.getUint8(o,!1)>127)return!0;return!1},r=this.ensureBinary(t);return e()?this.parseBinary(r):this.parseASCII(this.ensureString(t))},parseBinary:function(t){for(var e,r,n,a,i,o,s,f,u=new DataView(t),g=u.getUint32(80,!0),h=!1,p=0;70>p;p++)1129270351==u.getUint32(p,!1)&&82==u.getUint8(p+4)&&61==u.getUint8(p+5)&&(h=!0,a=new Float32Array(3*g*3),i=u.getUint8(p+6)/255,o=u.getUint8(p+7)/255,s=u.getUint8(p+8)/255,f=u.getUint8(p+9)/255);for(var l=84,c=50,y=0,w=new THREE.BufferGeometry,E=new Float32Array(3*g*3),d=new Float32Array(3*g*3),v=0;g>v;v++){var b=l+v*c,F=u.getFloat32(b,!0),T=u.getFloat32(b+4,!0),U=u.getFloat32(b+8,!0);if(h){var A=u.getUint16(b+48,!0);0===(32768&A)?(e=(31&A)/31,r=(A>>5&31)/31,n=(A>>10&31)/31):(e=i,r=o,n=s)}for(var B=1;3>=B;B++){var L=b+12*B;E[y]=u.getFloat32(L,!0),E[y+1]=u.getFloat32(L+4,!0),E[y+2]=u.getFloat32(L+8,!0),d[y]=F,d[y+1]=T,d[y+2]=U,h&&(a[y]=e,a[y+1]=r,a[y+2]=n),y+=3}}return w.addAttribute("position",new THREE.BufferAttribute(E,3)),w.addAttribute("normal",new THREE.BufferAttribute(d,3)),h&&(w.addAttribute("color",new THREE.BufferAttribute(a,3)),w.hasColors=!0,w.alpha=f),w},parseASCII:function(t){var e,r,n,a,i,o,s,f;for(e=new THREE.Geometry,a=/facet([\s\S]*?)endfacet/g;null!==(s=a.exec(t));){for(f=s[0],i=/normal[\s]+([\-+]?[0-9]+\.?[0-9]*([eE][\-+]?[0-9]+)?)+[\s]+([\-+]?[0-9]*\.?[0-9]+([eE][\-+]?[0-9]+)?)+[\s]+([\-+]?[0-9]*\.?[0-9]+([eE][\-+]?[0-9]+)?)+/g;null!==(s=i.exec(f));)n=new THREE.Vector3(parseFloat(s[1]),parseFloat(s[3]),parseFloat(s[5]));for(o=/vertex[\s]+([\-+]?[0-9]+\.?[0-9]*([eE][\-+]?[0-9]+)?)+[\s]+([\-+]?[0-9]*\.?[0-9]+([eE][\-+]?[0-9]+)?)+[\s]+([\-+]?[0-9]*\.?[0-9]+([eE][\-+]?[0-9]+)?)+/g;null!==(s=o.exec(f));)e.vertices.push(new THREE.Vector3(parseFloat(s[1]),parseFloat(s[3]),parseFloat(s[5])));r=e.vertices.length,e.faces.push(new THREE.Face3(r-3,r-2,r-1,n))}return e.computeBoundingBox(),e.computeBoundingSphere(),e},ensureString:function(t){if("string"!=typeof t){for(var e=new Uint8Array(t),r="",n=0;n<t.byteLength;n++)r+=String.fromCharCode(e[n]);return r}return t},ensureBinary:function(t){if("string"==typeof t){for(var e=new Uint8Array(t.length),r=0;r<t.length;r++)e[r]=255&t.charCodeAt(r);return e.buffer||e}return t}},"undefined"==typeof DataView&&(DataView=function(t,e,r){this.buffer=t,this.byteOffset=e||0,this.byteLength=r||t.byteLength||t.length,this._isString="string"==typeof t},DataView.prototype={_getCharCodes:function(t,e,r){e=e||0,r=r||t.length;for(var n=e+r,a=[],i=e;n>i;i++)a.push(255&t.charCodeAt(i));return a},_getBytes:function(t,e,r){var n;if(void 0===r&&(r=this._littleEndian),e=void 0===e?this.byteOffset:this.byteOffset+e,void 0===t&&(t=this.byteLength-e),"number"!=typeof e)throw new TypeError("DataView byteOffset is not a number");if(0>t||e+t>this.byteLength)throw new Error("DataView length or (byteOffset+length) value is out of bounds");return n=this.isString?this._getCharCodes(this.buffer,e,e+t):this.buffer.slice(e,e+t),!r&&t>1&&(n instanceof Array||(n=Array.prototype.slice.call(n)),n.reverse()),n},getFloat64:function(t,e){var r=this._getBytes(8,t,e),n=1-2*(r[7]>>7),a=((r[7]<<1&255)<<3|r[6]>>4)-1023,i=(15&r[6])*Math.pow(2,48)+r[5]*Math.pow(2,40)+r[4]*Math.pow(2,32)+r[3]*Math.pow(2,24)+r[2]*Math.pow(2,16)+r[1]*Math.pow(2,8)+r[0];return 1024===a?0!==i?0/0:1/0*n:-1023===a?n*i*Math.pow(2,-1074):n*(1+i*Math.pow(2,-52))*Math.pow(2,a)},getFloat32:function(t,e){var r=this._getBytes(4,t,e),n=1-2*(r[3]>>7),a=(r[3]<<1&255|r[2]>>7)-127,i=(127&r[2])<<16|r[1]<<8|r[0];return 128===a?0!==i?0/0:1/0*n:-127===a?n*i*Math.pow(2,-149):n*(1+i*Math.pow(2,-23))*Math.pow(2,a)},getInt32:function(t,e){var r=this._getBytes(4,t,e);return r[3]<<24|r[2]<<16|r[1]<<8|r[0]},getUint32:function(t,e){return this.getInt32(t,e)>>>0},getInt16:function(t,e){return this.getUint16(t,e)<<16>>16},getUint16:function(t,e){var r=this._getBytes(2,t,e);return r[1]<<8|r[0]},getInt8:function(t){return this.getUint8(t)<<24>>24},getUint8:function(t){return this._getBytes(1,t)[0]}});