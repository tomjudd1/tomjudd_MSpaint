THREE.TGALoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager},THREE.TGALoader.prototype=Object.create(THREE.BinaryTextureLoader.prototype),THREE.TGALoader.prototype._parser=function(e){function r(e){switch(e.image_type){case d:case g:(e.colormap_length>256||24!==e.colormap_size||1!==e.colormap_type)&&console.error("THREE.TGALoader.parse.tgaCheckHeader: Invalid type colormap data for indexed type");break;case h:case f:case u:case T:e.colormap_type&&console.error("THREE.TGALoader.parse.tgaCheckHeader: Invalid type colormap data for colormap type");break;case p:console.error("THREE.TGALoader.parse.tgaCheckHeader: No data");default:console.error('THREE.TGALoader.parse.tgaCheckHeader: Invalid type " '+e.image_type+'"')}(e.width<=0||e.height<=0)&&console.error("THREE.TGALoader.parse.tgaCheckHeader: Invalid image size"),8!==e.pixel_size&&16!==e.pixel_size&&24!==e.pixel_size&&32!==e.pixel_size&&console.error('THREE.TGALoader.parse.tgaCheckHeader: Invalid pixel size "'+e.pixel_size+'"')}function a(e,r,a,o,t){var i,s,n,c;if(s=a.pixel_size>>3,n=a.width*a.height*s,r&&(c=t.subarray(o,o+=a.colormap_length*(a.colormap_size>>3))),e){i=new Uint8Array(n);for(var l,p,d,h=0,f=new Uint8Array(s);n>h;)if(l=t[o++],p=(127&l)+1,128&l){for(d=0;s>d;++d)f[d]=t[o++];for(d=0;p>d;++d)i.set(f,h+d*s);h+=s*p}else{for(p*=s,d=0;p>d;++d)i[h+d]=t[o++];h+=p}}else i=t.subarray(o,o+=r?a.width*a.height:n);return{pixel_data:i,palettes:c}}function o(e,r,a,o,t,i,s,n,c){var l,p,d,h=c,f=0,g=v.width;for(d=r;d!==o;d+=a)for(p=t;p!==s;p+=i,f++)l=n[f],e[4*(p+g*d)+3]=255,e[4*(p+g*d)+2]=h[3*l+0],e[4*(p+g*d)+1]=h[3*l+1],e[4*(p+g*d)+0]=h[3*l+2];return e}function t(e,r,a,o,t,i,s,n){var c,l,p,d=0,h=v.width;for(p=r;p!==o;p+=a)for(l=t;l!==s;l+=i,d+=2)c=n[d+0]+(n[d+1]<<8),e[4*(l+h*p)+0]=(31744&c)>>7,e[4*(l+h*p)+1]=(992&c)>>2,e[4*(l+h*p)+2]=(31&c)>>3,e[4*(l+h*p)+3]=32768&c?0:255;return e}function i(e,r,a,o,t,i,s,n){var c,l,p=0,d=v.width;for(l=r;l!==o;l+=a)for(c=t;c!==s;c+=i,p+=3)e[4*(c+d*l)+3]=255,e[4*(c+d*l)+2]=n[p+0],e[4*(c+d*l)+1]=n[p+1],e[4*(c+d*l)+0]=n[p+2];return e}function s(e,r,a,o,t,i,s,n){var c,l,p=0,d=v.width;for(l=r;l!==o;l+=a)for(c=t;c!==s;c+=i,p+=4)e[4*(c+d*l)+2]=n[p+0],e[4*(c+d*l)+1]=n[p+1],e[4*(c+d*l)+0]=n[p+2],e[4*(c+d*l)+3]=n[p+3];return e}function n(e,r,a,o,t,i,s,n){var c,l,p,d=0,h=v.width;for(p=r;p!==o;p+=a)for(l=t;l!==s;l+=i,d++)c=n[d],e[4*(l+h*p)+0]=c,e[4*(l+h*p)+1]=c,e[4*(l+h*p)+2]=c,e[4*(l+h*p)+3]=255;return e}function c(e,r,a,o,t,i,s,n){var c,l,p=0,d=v.width;for(l=r;l!==o;l+=a)for(c=t;c!==s;c+=i,p+=2)e[4*(c+d*l)+0]=n[p+0],e[4*(c+d*l)+1]=n[p+0],e[4*(c+d*l)+2]=n[p+0],e[4*(c+d*l)+3]=n[p+1];return e}function l(e,r,a,l){var p,d,h,f,g,u,T=new Uint8Array(e*r*4);switch((v.flags&E)>>_){default:case y:p=0,h=1,g=e,d=0,f=1,u=r;break;case k:p=0,h=1,g=e,d=r-1,f=-1,u=-1;break;case m:p=e-1,h=-1,g=-1,d=0,f=1,u=r;break;case w:p=e-1,h=-1,g=-1,d=r-1,f=-1,u=-1}if(x)switch(v.pixel_size){case 8:n(T,d,f,u,p,h,g,a);break;case 16:c(T,d,f,u,p,h,g,a);break;default:console.error("THREE.TGALoader.parse.getTgaRGBA: not support this format")}else switch(v.pixel_size){case 8:o(T,d,f,u,p,h,g,a,l);break;case 16:t(T,d,f,u,p,h,g,a);break;case 24:i(T,d,f,u,p,h,g,a);break;case 32:s(T,d,f,u,p,h,g,a);break;default:console.error("THREE.TGALoader.parse.getTgaRGBA: not support this format")}return T}var p=0,d=1,h=2,f=3,g=9,u=10,T=11,E=48,_=4,k=0,w=1,y=2,m=3;e.length<19&&console.error("THREE.TGALoader.parse: Not enough data to contain header.");var H=new Uint8Array(e),b=0,v={id_length:H[b++],colormap_type:H[b++],image_type:H[b++],colormap_index:H[b++]|H[b++]<<8,colormap_length:H[b++]|H[b++]<<8,colormap_size:H[b++],origin:[H[b++]|H[b++]<<8,H[b++]|H[b++]<<8],width:H[b++]|H[b++]<<8,height:H[b++]|H[b++]<<8,pixel_size:H[b++],flags:H[b++]};r(v),v.id_length+b>e.length&&console.error("THREE.TGALoader.parse: No data"),b+=v.id_length;var A=!1,R=!1,x=!1;switch(v.image_type){case g:A=!0,R=!0;break;case d:R=!0;break;case u:A=!0;break;case h:break;case T:A=!0,x=!0;break;case f:x=!0}var G=a(A,R,v,b,H),L=l(v.width,v.height,G.pixel_data,G.palettes);return{width:v.width,height:v.height,data:L}};